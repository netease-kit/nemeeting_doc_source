本文介绍如何通过网易会议组件管理会议的相关示例。

## 前提条件

根据本文操作前，请确保您已经完成了 [登录鉴权](https://doc.yunxin.163.com/meeting/guide/TAzNjk1MDc?platform=android)。

## 离开或结束会议

您可以调用 [`leaveCurrentMeeting`](https://doc.yunxin.163.com/meetingkit/references/android/dokka/Latest/zh/com/netease/yunxin/kit/meeting/sdk/NEMeetingService.html#leaveCurrentMeeting(int,com.netease.yunxin.kit.meeting.sdk.NECallback)) 离开当前进行中的会议，并通过参数控制（`leaveMeetingType`）是否同时结束当前会议。

```Java
// 获取NEMeetingKit的实例
NEMeetingKit meetingKit = NEMeetingKit.getInstance();
// 获取会议服务
NEMeetingService meetingService = meetingKit.getMeetingService();

/**
* leaveMeetingType
* 0 所有设备离开会议
* 1 仅当前设备离开会议（当非多端入会场景时，调用仅当前设备离开会议等同于离开会议）
* 2 结束会议（仅当前账号是会议主持人/联席主持人时，该参数才有效。当非管理员时，调用结束会议等同于所有设备离开会议）
*/

// 离开当前会议
meetingService.leaveCurrentMeeting(leaveMeetingType, new NECallback<Void>() {
    @Override
    public void onResult(int resultCode, String resultMsg, Void result) {
        if (resultCode == NEMeetingError.ERROR_CODE_SUCCESS) {
            // 离开会议成功
            System.out.println("成功离开会议");
        } else {
            // 离开会议失败
            System.out.println("离开会议失败: " + resultMsg);
        }
    }
});
```

## <span id="使用会议设置服务">查询用户的会议设置</span>

通过会议设置服务，设置和查询用户的当前会议设置，例如入会时的音视频开关状态、会议持续时间的显示等。

::: note note
- 每个已登录的用户有自己独立的一份会议设置项。其他所有未登录用户、匿名用户共享一份会议设置项。
- 会议设置项仅在当前设备上保存，不会漫游。
- 调用创建会议或加入会议方法时，若您设置 `NEMeetingOptions` 参数为 null，SDK 会使用会议设置服务中已保存的相关配置进行创会/入会。
:::

1. 调用 [`getSettingsService`](https://doc.yunxin.163.com/meetingkit/references/android/dokka/Latest/zh/com/netease/yunxin/kit/meeting/sdk/NEMeetingKit.html#getSettingsService()) 方法获取会议设置服务。

    **示例代码如下：**

    ```Java
    NESettingsService settingsService = NEMeetingKit.getInstance().getSettingsService();
    ```

2. 调用不同方法设置或查询会议设置项。

    - 设置或查询通用入会设置项

        **示例代码如下：**

        ```Java
        // 设置并保存会议设置
        settingsService.enableTurnOnMyAudioWhenJoinMeeting(true);
        settingsService.enableTurnOnMyVideoWhenJoinMeeting(true);

        //查询会议设置
        boolean audioEnabled = settingsService.isTurnOnMyAudioWhenJoinMeetingEnabled();
        boolean videoEnabled = settingsService.isTurnOnMyVideoWhenJoinMeetingEnabled();
        ```

    - 查询直播开通状态

        **示例代码如下：**

        ```Java
        /**
        * 查询直播开通状态
        * @return true-打开，false-关闭
        */
        NEMeetingKit.getInstance().getSettingsService().isMeetingLiveSupported();
        ```

## <span id="获取当前会议信息">获取当前会议信息</span>

在已经完成 SDK 登录鉴权的状态下，获取当前会议信息。

调用 [`getCurrentMeetingInfo`](https://doc.yunxin.163.com/meetingkit/references/android/dokka/Latest/zh/com/netease/yunxin/kit/meeting/sdk/NEMeetingService.html#getCurrentMeetingInfo(com.netease.yunxin.kit.meeting.sdk.NECallback)) 方法获取当前会议信息并进行回调处理。该接口的回调结果的数据类型为 [`NEMeetingInfo`](https://doc.yunxin.163.com/meetingkit/references/android/dokka/Latest/zh/com/netease/yunxin/kit/meeting/sdk/NEMeetingInfo.html) 对象类型。

::: note note
请确认已经通过一种入会方式（加入会议/创建会议/匿名入会）加入到会议内，否则回调数据对象为空。
:::

**示例代码如下：**

```Java
NEMeetingKit.getInstance().getMeetingService().getCurrentMeetingInfo(new NECallback<NEMeetingInfo>() {
    @Override
    public void onResult(int resultCode, String resultMsg, NEMeetingInfo resultData) {
        Log.d("OnCustomMenuListener", "getCurrentMeetingInfo:resultCode " + resultCode + "#resultData " + resultData.toString());
    }
});
```

## <span id="监听会议状态">监听会议状态</span>

通过注册会议状态回调接口，获取会议状态变更的通知。

1. 注册回调开始监听，并在回调方法中根据您的需求处理相应事件。

    ::: note note
    - 该接口在初始化 SDK 成功后即可调用。
    - 一次会议状态变更回调可能包含多个会议信息的变更。
    :::

    **示例代码如下：**

    ```Java
    NEMeetingStatusListener listener = new NEMeetingStatusListener() {

    @Override
    public void onMeetingStatusChanged(Event event) {
        // code
    }
    };
    NEMeetingKit.getInstance().getMeetingService().addMeetingStatusListener(listener);
    ```

2. 反注册回调接口 [`removeMeetingStatusListener`](https://doc.yunxin.163.com/meetingkit/references/android/dokka/Latest/zh/com/netease/yunxin/kit/meeting/sdk/NEMeetingService.html#removeMeetingStatusListener(com.netease.yunxin.kit.meeting.sdk.NEMeetingStatusListener)) 停止监听。

    **示例代码如下：**

    ```Java
    NEMeetingKit.getInstance().getMeetingService().removeMeetingStatusListener(listener);
    ```

## <span id="监听全局事件">监听全局事件</span>

通过注册全局事件回调接口，获取相应事件通知，目前支持监听 RTC 初始化和销毁相关的事件。

1. 注册回调接口 [`addGlobalEventListener`](https://doc.yunxin.163.com/meetingkit/references/android/dokka/Latest/zh/com/netease/yunxin/kit/meeting/sdk/NEMeetingKit.html#addGlobalEventListener(com.netease.yunxin.kit.meeting.sdk.NEGlobalEventListener)) 开始监听，并在回调方法中根据您的需求处理相应事件。

    ::: note note
    该接口在初始化 SDK 成功后即可调用。
    :::

    **示例代码如下：**

    ```Java
    NEMeetingKit.getInstance().addGlobalEventListener(new NEGlobalEventListener() {
    @Override
    public void beforeRtcEngineInitialize(String meetingNum, NERtcWrapper rtcWrapper) {
        //引擎初始化前回调
    }

    @Override
    public void afterRtcEngineInitialize(String meetingNum, NERtcWrapper rtcWrapper) {
        //引擎初始化后回调
    }

    @Override
    public void beforeRtcEngineRelease(String meetingNum, NERtcWrapper rtcWrapper) {
        //引擎销毁前回调
    }
    });
    ```

2. 反注册回调接口 [`removeGlobalEventListener`](https://doc.yunxin.163.com/meetingkit/references/android/dokka/Latest/zh/com/netease/yunxin/kit/meeting/sdk/NEMeetingKit.html#removeGlobalEventListener(com.netease.yunxin.kit.meeting.sdk.NEGlobalEventListener)) 停止监听。

    **示例代码如下：**

    ```Java
    NEMeetingKit.getInstance().removeGlobalEventListener(listener);
    ```