本文介绍了网易会议组件（NEMeetingKit）提供的登录鉴权方式和示例。

## <span id="登录鉴权">调用时机</span>

您只有完成网易会议组件登录鉴权才可以使用网易会议组件的相关接口，包括创建会议、加入会议、编辑预约会议等。

## 前提条件

根据本文操作前，请确保您已经完成了以下操作：

- [初始化会议组件](https://doc.yunxin.163.com/meeting/guide/jgyOTU0OTE?platform=h5#初始化)。
- 调用服务端接口 [创建会议账号](https://doc.yunxin.163.com/meeting/server-apis/jU0MDAzNTg?platform=server)。

## 登录方式

网易会议组件提供了多种登录方式供您选择，具体通过 [`NEAccountService`](https://doc.yunxin.163.com/meetingkit/references/web/typedoc/Latest/zh/h5/interfaces/NEAccountService.html) 实现，如下表所示。

<style>
table th:first-of-type {
    width: 40%;
}
table th:nth-of-type(2) {
    width: 60%;
}
</style>

| 实现接口 | 登录方式说明 |
| --- | --- |
| [loginByEmail](https://doc.yunxin.163.com/meetingkit/references/web/typedoc/Latest/zh/h5/interfaces/NEAccountService.html#loginByEmail) | 通过邮箱密码登录鉴权。 |
| [loginByPassword](https://doc.yunxin.163.com/meetingkit/references/web/typedoc/Latest/zh/h5/interfaces/NEAccountService.html#loginByPassword) | 通过用户唯一 ID 和密码登录鉴权。 |
| [loginByPhoneNumber](https://doc.yunxin.163.com/meetingkit/references/web/typedoc/Latest/zh/h5/interfaces/NEAccountService.html#loginByPhoneNumber) | 通过电话号码密码登录鉴权。 |
| [loginByToken](https://doc.yunxin.163.com/meetingkit/references/web/typedoc/Latest/zh/h5/interfaces/NEAccountService.html#loginByToken) | 根据用户唯一 ID 和 Token 登录鉴权。 |
| [tryAutoLogin](https://doc.yunxin.163.com/meetingkit/references/web/typedoc/Latest/zh/h5/interfaces/NEAccountService.html#tryAutoLogin) | 尝试使用最近一次成功登录过的账号信息，进行自动登录。 |

:::note note
账号参数信息（`userUuid` 和 `token`）请从服务端接口 <a href="https://doc.yunxin.163.com/meeting/server-apis/jU0MDAzNTg?platform=server" target="_blank">meeting/api/v2/add-user</a> 获取，由您自行实现相关业务逻辑。
:::

## 登录示例

以下通过 **Token 登录**（`loginByToken`）方式为例，说明 NEMeetingKit 的登录鉴权逻辑，其他登录方式的鉴权逻辑同理。

1. 调用服务端接口 [创建账号](https://doc.yunxin.163.com/meeting/server-apis/jU0MDAzNTg?platform=server) 获取账号和 token。

2. 调用 [`loginByToken`](https://doc.yunxin.163.com/meetingkit/references/web/typedoc/Latest/zh/h5/interfaces/NEAccountService.html#loginByToken) 方法登录并进行回调处理，该接口无额外回调结果数据。

    **示例代码** 如下：

    ```JavaScript
    //使用 账号密码 登录
    const neMeetingKit = NEMeetingKit.getInstance()
    const accountService = neMeetingKit.getAccountService()
    // 用户账户
    const userUuid = ''
    // 用户 token
    const token = ''
    accountService.loginByToken(userUuid, token).then(res => {
        // 登录成功
    }).catch(error => {
        // 登录失败
    })
    ```

## 获取用户信息

（可选）登录成功后，您可能需要获取用户的账号信息以进行进一步的操作，例如更新 UI、同步数据或验证用户权限。

[`getAccountInfo`](https://doc.yunxin.163.com/meetingkit/references/web/typedoc/Latest/zh/h5/types/NEAccountServiceListener.html) 方法提供了一个异步的回调接口来获取这些信息。以下是如何在登录成功后调用 `getAccountInfo` 方法，并处理返回的账号信息。

```JavaScript
//使用 账号密码 登录
const neMeetingKit = NEMeetingKit.getInstance()
const accountService = neMeetingKit.getAccountService()
accountService.getAccountInfo().then((res) => {
const { data } = res
// data 账号信息
})
```

## 监听登录状态

您可以注册账号信息变更、用户登录信息变更等相关监听（[`NEAccountServiceListener`](https://doc.yunxin.163.com/meetingkit/references/web/typedoc/Latest/zh/h5/types/NEAccountServiceListener.html)），及时处理相关跳转以增强用户体验。

```JavaScript
const neMeetingKit = NEMeetingKit.getInstance()
const meetingService = neMeetingKit.getMeetingService()

meetingService.addMeetingStatusListener({
    onAccountInfoUpdated: ({status}) = {
        // status: 账号信息已更新
    },
    onAuthInfoExpired: () => {
        // 认证信息过期时的处理逻辑
        // 可以在这里重新登录或提示用户
    },
    onKickOut: () => {
        // 被踢下线时的处理逻辑
        // 可以在这里提示用户或重新登录
    },
    onReconnected: () => {
        // 重新连接成功时的处理逻辑
        / 可以在这里刷新 UI 或同步数据
    }
})
```

## 注销登录

注销登录时，会注销当前用户已登录的账号，返回未登录状态。您可以调用 [`logout`](https://doc.yunxin.163.com/meetingkit/references/web/typedoc/Latest/zh/h5/interfaces/NEAccountService.html#logout) 方法注销当前账号并进行回调处理。该接口无额外回调结果数据，您可根据错误码判断接口是否调用成功。

::: note note
账号注销后，登录状态会被清空，且无法再使用该账号创建会议。
:::

**示例代码** 如下：

```JavaScript
//账户登出
const neMeetingKit = NEMeetingKit.getInstance()
const accountService = neMeetingKit.getAccountService()

accountService.logout().then(() => {
    // 注销登录成功
}).catch((error) => {
    // 注销登录失败
})
```