本文介绍如何通过网易会议组件预约会议，并进行预约会议的管理，包括编辑预约会议、取消预约会议、查询预约会议信息、查询指定状态下的预约会议列表。

## 前提条件

根据本文操作前，请确保您已经完成了 [登录鉴权](https://doc.yunxin.163.com/meeting/guide/DM0OTEwMjQ)。

## <span id="预约会议">预约会议</span>

在已经完成 SDK 登录鉴权的状态下，预约一个新的会议。

调用 [`scheduleMeeting`](https://doc.yunxin.163.com/meetingkit/references/web/typedoc/Latest/zh/electron/interfaces/NEPreMeetingService.html#scheduleMeeting) 方法预约会议并进行回调处理，您可根据错误码判断接口是否调用成功。

::: note note
- 该接口仅支持 **在登录鉴权成功后调用**，其他情况下会调用失败。
- 预约会议时，`scheduleMeeting` 接口中的参数 `NEMeetingItem`，必须是 `createScheduleMeetingItem` 返回的 `NEMeetingItem` 对象。
:::

**示例代码** 如下：

```javascript
try {
    const neMeetingKit = NEMeetingKit.getInstance();
    const preMeetingService = neMeetingKit.getPreMeetingService();

    const { data: meetingItem } = await preMeetingService.createScheduleMeetingItem();  

    meetingItem.subject = "会议主题";
    await preMeetingService.scheduleMeeting(meetingItem);
    // 预约会议成功
} catch (error) {
    // 预约会议失败
}
```

## <span id="编辑预约会议">编辑预约会议</span>

在已经完成 SDK 登录鉴权的状态下，编辑一个已经预约的会议。

调用 `editMeeting` 方法编辑会议并进行回调处理，您可根据错误码判断接口是否调用成功。

::: note note
该接口仅支持 **在登录鉴权成功后调用**，其他情况下会调用失败。
:::

**示例代码** 如下：

```javascript
const neMeetingKit = NEMeetingKit.getInstance();
const preMeetingService = neMeetingKit.getPreMeetingService();

try {
    // 获取会议信息
    const meetingNum = '您的会议号';
    const { data: meetingItem } = await preMeetingService.getMeetingItemByNum(meetingNum);
    meetingItem.subject = "新的会议主题";
    await preMeetingService.editMeeting(meetingItem);
} catch (error) {
    // 编辑预约会议失败
}
```

## <span id="取消预约会议">取消预约会议</span>

在已经完成 SDK 登录鉴权的状态下，取消一个已经预约的会议。

调用 `cancelMeeting` 方法取消预约会议并进行回调处理，您可根据错误码判断接口是否调用成功。

::: note note
- 该接口仅支持 **在登录鉴权成功后调用**，其他情况下会调用失败。
- 取消预约会议时，`cancelMeeting` 接口中的参数 `meetingId` 是服务端返回的唯一码，请从 `NEMeetingItem#meetingId` 处获取。
- 您无法取消正在进行中的、处于回收状态的或已经结束的会议。
:::

**示例代码** 如下：

```javascript
const neMeetingKit = NEMeetingKit.getInstance();
const preMeetingService = neMeetingKit.getPreMeetingService();

try {
    const meetingId = 123;
    await preMeetingService.cancelMeeting(meetingId);
} catch (error) {
    // 取消预约会议失败
}
```

## <span id="查询预约会议信息">查询预约会议信息</span>

在已经完成 SDK 登录鉴权的状态下，查询一个已经预约的会议的信息。

调用 `getMeetingItemByNum` 方法查询预约会议信息并进行回调处理，您可根据错误码判断接口是否调用成功。

::: note note
- 该接口仅支持 **在登录鉴权成功后调用**，其他情况下会调用失败。
- 查询预约会议的信息时，`getMeetingItemByNum` 接口中的参数 `meetingNum` 是服务端返回的会议号，请从 `NEMeetingItem#meetingNum` 处获取。
:::

**示例代码** 如下：

```javascript
const neMeetingKit = NEMeetingKit.getInstance();
const preMeetingService = neMeetingKit.getPreMeetingService();

try {
    const meetingNum = '您的会议号';
    const { data: meetingItem } = await preMeetingService.getMeetingItemByNum(meetingNum);
} catch (error) {
    // 查询预约会议信息失败
}
```

## <span id="查询指定状态下的预约会议列表">查询指定状态下的预约会议列表</span>

在已经完成 SDK 登录鉴权的状态下，根据指定的一种或多种会议状态在已预约的所有会议基础上筛选出会议列表。

调用 `getScheduledMeetingList` 方法查询指定状态下的预约会议列表并进行回调处理，您可根据错误码判断接口是否调用成功。

::: note note
- 该接口仅支持 **在登录鉴权成功后调用**，其他情况下会调用失败。
- 调用此接口时，默认返回最近一个月的指定会议列表。
:::

**示例代码** 如下：

```javascript
const neMeetingKit = NEMeetingKit.getInstance();
const preMeetingService = neMeetingKit.getPreMeetingService();

try {
    const status = [NEMeetingItemStatus.init, NEMeetingItemStatus.started, NEMeetingItemStatus.ended];
    const { data: meetingItemList } = await preMeetingService.getScheduledMeetingList(status);
} catch (error) {
    // 查询指定状态下的预约会议列表失败
}
```

## <span id="监听预约会议状态">监听预约会议状态</span>

通过注册预约会议状态回调接口，获取预约会议状态变更的通知。

1. 注册回调接口 `addListener` 开始监听，并在回调方法中根据您的需求处理相应事件。

    ::: note note
    该接口在初始化 SDK 成功后即可调用。
    :::

   **示例代码** 如下：

    ```javascript
    const neMeetingKit = NEMeetingKit.getInstance();
    const preMeetingService = neMeetingKit.getPreMeetingService();

    const listener = {
        onMeetingItemInfoChanged: (meetingItemList) => {
            // 预约会议状态变更时的处理逻辑
        }
    };
    preMeetingService.addListener(listener);
    ```

2. 反注册回调接口 `removeListener` 停止监听。

   **示例代码** 如下：

    ```javascript
    const neMeetingKit = NEMeetingKit.getInstance();
    const preMeetingService = neMeetingKit.getPreMeetingService();

    preMeetingService.removeListener(listener);
    ```