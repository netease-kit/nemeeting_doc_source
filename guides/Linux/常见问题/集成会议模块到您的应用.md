# 集成会议模块到您的应用

本文档详细介绍如何将网易会议SDK集成到您的外部业务系统中，实现用户状态或会议事件在两个系统间的无缝同步。

## 集成流程

### 1. 初始化

在应用启动时，同时初始化网易会议SDK和外部业务系统，确保两个系统的初始化操作同步进行。

**示例代码如下：**

```cpp
// 同时初始化网易会议SDK和外部业务系统
auto neMeetingSDK = NEMeetingKit::getInstance();

// 初始化外部业务系统
ExternalBusinessSystem::Initialize(appKey, token);

neMeetingSDK->initialize(appKey, secret, [](int errorCode, const std::string& errorMessage) {
    if (errorCode == 0) {
        // 网易会议SDK初始化成功
    } else {
        // 网易会议SDK初始化失败
    }
});
```

### 2. 登录

用户登录时，确保网易会议SDK和外部业务系统的登录操作同步进行，保证两个系统的登录状态一致。

**示例代码如下：**

```cpp
// 登录外部业务系统
ExternalBusinessSystem::Login(username, password, [](bool success, const std::string& error) {
    if (success) {
        // 外部业务系统登录成功后，登录网易会议SDK
        auto neMeetingSDK = NEMeetingKit::getInstance();
        neMeetingSDK->login(userId, token, [](int errorCode, const std::string& errorMessage) {
            if (errorCode == 0) {
                // 网易会议SDK登录成功
            } else {
                // 网易会议SDK登录失败
            }
        });
    } else {
        // 外部业务系统登录失败
    }
});
```

### 3. 登出

用户登出时，同步登出网易会议SDK和外部业务系统，确保两个系统的登出状态一致。

**示例代码如下：**

```cpp
// 登出外部业务系统
ExternalBusinessSystem::Logout([](bool success, const std::string& error) {
    if (success) {
        // 外部业务系统登出成功后，登出网易会议SDK
        auto neMeetingSDK = NEMeetingKit::getInstance();
        neMeetingSDK->logout([](int errorCode, const std::string& errorMessage) {
            if (errorCode == 0) {
                // 网易会议SDK登出成功
            } else {
                // 网易会议SDK登出失败
            }
        });
    } else {
        // 外部业务系统登出失败
    }
});
```

### 4. 会议状态同步

通过添加会议状态监听器，实时获取会议状态变化并通知外部业务系统当前的会议状态。

**示例代码如下：**

```cpp
// 监听会议状态变化
auto neMeetingSDK = NEMeetingKit::getInstance();
neMeetingSDK->setMeetingStatusObserver([](NEEnumMeetingStatus status) {
    // 根据会议状态更新外部业务系统状态
    ExternalBusinessSystem::UpdateMeetingStatus(status);
    
    // 通知外部业务系统当前的会议状态
    switch (status) {
        case NEEnumMeetingStatus::MEETING_STATUS_CONNECTING:
            // 当前正在创建或加入会议
            ExternalBusinessSystem::NotifyMeetingConnecting();
            break;
        case NEEnumMeetingStatus::MEETING_STATUS_INMEETING:
            // 当前处于会议中
            ExternalBusinessSystem::NotifyMeetingInMeeting();
            break;
        case NEEnumMeetingStatus::MEETING_STATUS_IDLE:
            // 当前未处于任何会议中
            ExternalBusinessSystem::NotifyMeetingIdle();
            break;
        default:
            break;
    }
});
```

## 最佳实践

1. **错误处理**：在同步过程中，确保对每个操作都有适当的错误处理和重试机制
2. **性能优化**：避免频繁的状态更新，可采用防抖机制减少不必要的API调用
3. **数据一致性**：在用户离线或网络异常情况下，确保数据能够正确同步
4. **安全性**：确保用户隐私数据在两个系统间的安全传输

## 常见问题解答

**Q: 如何将网易会议初始化和登录与外部业务系统保持一致？**

A: 网易会议初始化和登录应保持跟外部业务系统初始化登录调用时机保持一致，确保两个系统的用户状态同步。

**Q: 如何集成外部业务系统能力与网易会议SDK，实现用户状态或会议事件及时同步？**

A: 外部业务系统监听会议状态变更事件，进行业务通知等。如果要利用外部业务系统来实现会议邀请，可以参考 会议管理/邀请入会.md 文档。

**Q: 如何处理网络异常情况下的状态同步？**

A: 建议实现本地缓存机制，在网络恢复后重新同步未完成的操作，并提供适当的状态回退策略。

**Q: 是否支持自定义会议事件类型？**

A: 是的，可以通过自定义会议事件监听器来扩展会议事件类型，并根据业务需求推送至外部业务系统。