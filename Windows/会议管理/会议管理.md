本文介绍如何通过网易会议组件管理会议的相关示例。

## 前提条件

根据本文操作前，请确保您已经完成了 [登录鉴权](https://doc.yunxin.163.com/meeting/guide/jU0MTcwNDY?platform=windows)。

## 离开或结束会议

您可以调用 [`leaveCurrentMeeting`](https://doc.yunxin.163.com/docs/interface/meetingkit/windows/doxygen/Latest/zh/class_n_e_meeting_service.html#abd4bc770a4d9bcea04d9c2d5375f271c) 离开当前进行中的会议，并通过参数控制（`leaveMeetingType`）是否同时结束当前会议。

```C++
m_meetingService->leaveCurrentMeeting(leaveMeetingType, [this](MeetingErrorCode errorCode, const std::string& errorMessage) {
        });
```

## <span id="使用会议设置服务">查询用户的会议设置</span>

通过会议设置服务，设置和查询用户的当前会议设置，例如入会时的音视频开关状态、会议持续时间的显示等。

::: note note
- 每个已登录的用户有自己独立的一份会议设置项。其他所有未登录用户、匿名用户共享一份会议设置项。
- 会议设置项仅在当前设备上保存，不会漫游。
- 调用创建会议或加入会议方法时，若您设置 `NEMeetingOptions` 参数为 null，SDK 会使用会议设置服务中已保存的相关配置进行创会/入会。
:::

1. 调用 [`getSettingsService`](https://doc.yunxin.163.com/docs/interface/meetingkit/windows/doxygen/Latest/zh/class_n_e_meeting_kit.html#af3cdeb4a8ca38310c758264750de9b06) 方法获取会议设置服务。

    **示例代码如下：**

    ```C++
    auto service = NEMeetingKit::getInstance()->getSettingsService();  
    ```

2. 调用不同方法设置或查询会议设置项。

    - 设置或查询通用入会设置项。

        **示例代码如下：**

        ```C++
        // 设置并保存会议设置
        auto svc = NEMeetingKit::getInstance()->getSettingsService(); 
        svc->enableTurnOnMyAudioWhenJoinMeeting(enable, resp);
        svc->enableTurnOnMyVideoWhenJoinMeeting(enable, resp);

        //查询会议设置
        svc->isTurnOnMyAudioWhenJoinMeetingEnabled(boolCb);
        svc->isTurnOnMyVideoWhenJoinMeetingEnabled(boolCb);
        ```

    - 查询直播开通状态。

        **示例代码如下：**

        ```C++
        auto svc = NEMeetingKit::getInstance()->getSettingsService();
        svc->isMeetingLiveSupported(boolCb);
        ```

## <span id="获取当前会议信息">获取当前会议信息</span>

在已经完成 SDK 登录鉴权的状态下，获取当前会议信息。

调用 [`getCurrentMeetingInfo`](https://doc.yunxin.163.com/docs/interface/meetingkit/windows/doxygen/Latest/zh/class_n_e_meeting_service.html#ac18903de29f544e9755ab9eb5e8c9b1d) 方法获取当前会议信息并进行回调处理。该接口的回调结果的数据类型为 [`NEMeetingInfo`](https://doc.yunxin.163.com/docs/interface/meetingkit/windows/doxygen/Latest/zh/kit__define__meeting_8h.html#ae54c7509d650ecda1a8cbefebcfd73f3) 对象类型。

::: note note
请确认已经通过一种入会方式（加入会议/创建会议/匿名入会）加入到会议内，否则回调数据对象为空。
:::

**示例代码如下：**

```C++
auto m_meetingService = NEMeetingKit::getInstance()->getMeetingService();
m_meetingService->getCurrentMeetingInfo([this](
                                                    MeetingErrorCode errorCode, const std::string& errorMessage, const NEMeetingInfo& meetingInfo) {
        });
```

## <span id="监听会议状态">监听会议状态</span>

通过注册会议状态回调接口，获取会议状态变更的通知。

1. 注册回调开始监听，并在回调方法中根据您的需求处理相应事件。

    ::: note note
    - 该接口在初始化 SDK 成功后即可调用。
    - 一次会议状态变更回调可能包含多个会议信息的变更。
    :::

    **示例代码如下：**

    ```C++
    void MainWindow::onMeetingStatusChanged(const Event& event) {
        PrintLog("Meeting status changed, event: " + xpack::json::encode(event));
    }
    auto svc = NEMeetingKit::getInstance()->getMeetingService();
    svc->addListener(this);
    ```

2. 反注册回调接口 [`removeMeetingStatusListener`](https://doc.yunxin.163.com/docs/interface/meetingkit/windows/doxygen/Latest/zh/class_n_e_meeting_service.html#a66bc2bb115892a4fee02ebbf401060d6) 停止监听。

    **示例代码如下：**

    ```C++
    auto svc = NEMeetingKit::getInstance()->getMeetingService();
    svc->removeMeetingStatusListener(this);
    ```
