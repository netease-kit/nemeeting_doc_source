本文介绍如何在 Linux 框架上使用网易会议组件 NEMeetingKit 进行菜单定制。

## 功能介绍

NEMeetingKit 支持通过 [`NEMeetingOptions`](https://doc.yunxin.163.com/docs/interface/meetingkit/linux/doxygen/Latest/zh/class_n_e_meeting_options.html) 对会议界面中的菜单项进行自定义，包括工具栏菜单、更多菜单和成员操作菜单。

菜单的自定义包括修改文本、定制图标、菜单排序、菜单新增与删除等操作。

菜单类型分为两种：

- **单状态菜单**：只有一个固定状态，单击后执行相应操作（例如：打开设置）。
- **多状态菜单**：有多个状态，单击后可在不同状态间切换（例如：麦克风开/关、摄像头开/关）。

## 自定义工具栏菜单

工具栏菜单位于会议界面底部和顶部的主要控制区域。

<img alt="image.png" src="https://yx-web-nosdn.netease.im/common/9895d4e69fec612fbbfc64638a21f19e/PixPin_2026-01-05_10-21-07.png" style="width:50%;border: 1px solid #BFBFBF;">

**示例代码如下：**

```C++
NEJoinMeetingParams params;
params.meetingId = "123456789";
params.displayName = "Meeting";

NEJoinMeetingOptions options;
options.noAudio = true;
options.noVideo = true;

NEMeetingMenuItem menuItem;
#ifdef _WIN32
    menuItem.itemImage = "C://feedback.png";
#else
    menuItem.itemImage = "/Users/XX/feedback.png";
#endif
    
menuItem.itemId = 101;
menuItem.itemTitle = tr("Feedback").toStdString();
options.full_toolbar_menu_items_.push_back(menuItem);

ipcMeetingService->joinMeeting(params, options, [this](NEErrorCode errorCode, const std::string& errorMessage) {
});
```

:::note note
自定义菜单 ID 应避免与 **NEMenuIDs** 中定义的内置菜单 ID 冲突。使用大于 100 的整数值作为自定义菜单 ID。如需修改或管理内置菜单，则应使用相应的内置菜单 ID 常量。
:::

## 自定义更多菜单

更多菜单是指单击会议界面底部 **更多** 按钮后显示的菜单项。

<img alt="image.png" src="https://yx-web-nosdn.netease.im/common/f7e624115d4cc0a9c4da03ef6e723e77/PixPin_2026-01-05_10-21-20.png" style="width:50%;border: 1px solid #BFBFBF;">

**示例代码如下：**

```C++
NEJoinMeetingParams params;
params.meetingId = "123456789";
params.displayName = "Meeting";

NEJoinMeetingOptions options;
options.noAudio = true;
options.noVideo = true;

NEMeetingMenuItem menuItem;
#ifdef _WIN32
    menuItem.itemImage = "C://feedback.png";
#else
    menuItem.itemImage = "/Users/XX/feedback.png";
#endif
    
menuItem.itemId = 101;
menuItem.itemTitle = tr("Feedback").toStdString();
options.full_more_menu_items_.push_back(menuItem);

ipcMeetingService->joinMeeting(params, options, [this](NEErrorCode errorCode, const std::string& errorMessage) {
});
```

## 自定义成员上下文菜单

成员上下文菜单是指单击 **管理参会者** 图表后在管理参会者的页面中，单击某个成员后弹出的操作菜单。

<img alt="image.png" src="https://yx-web-nosdn.netease.im/common/e120b4eeca472c08cdf28581d466b40a/Screenshot 2026-01-05 at 10.25.41.png" style="width:50%;border: 1px solid #BFBFBF;">

**示例代码如下：**

```C++
ams.displayName = "Meeting";

NEJoinMeetingOptions options;
options.noAudio = true;
options.noVideo = true;

std::vector<NEMeetingMenuItemPtr> memberActionMenuItems;
memberActionMenuItems.push_back(nem_sdk_interface::NEActionMenuItems::audio());
options.memberActionMenuItems = memberActionMenuItems;

ipcMeetingService->joinMeeting(params, options, [this](NEErrorCode errorCode, const std::string& errorMessage) {
});
```

## 主动更新自定义菜单

在会议过程中，可以调用 [`updateInjectedMenuItem`](https://doc.yunxin.163.com/docs/interface/meetingkit/linux/doxygen/Latest/zh/class_n_e_meeting_service.html#a2d112b1cd6b4501d8b14831636a4272b) 根据需要实时更新已添加的自定义菜单。

**示例代码如下：**

```C++
NEMeetingMenuItemPtr menuItem = std::make_shared<NEMeetingMenuItem>();
m_meetingService->updateInjectedMenuItem(menuItem, [this](MeetingErrorCode errorCode, const std::string& errorMessage) {
            PrintLog("MeetingSDK updateInjectedMenuItem errorCode: " + std::to_string(errorCode) + ", errorMessage: " + errorMessage);
        });
```

## 监听菜单单击事件

要响应自定义菜单的单击事件，您需要设置菜单单击监听器。

**示例代码如下：**

```C++
// 继承按钮点击状态变更类，并处理点击
class NEMeetingMenuItemClickListener : public NEMeetingOnInjectedMenuItemClickListener {
public:
explicit NEMeetingMenuItemClickListener() {}
~NEMeetingMenuItemClickListener() {}

// 处理点击
virtual void onInjectedMenuItemClick(const NEMeetingMenuItem& meeting_menu_item) {}
// 处理点击，并回调状态变更
virtual void onInjectedMenuItemClickEx(const NEMeetingMenuItem& meeting_menu_item, const NEInjectedMenuItemClickCallback& cb) {}
};

NEMeetingMenuItemClickListener listener;
// 注册监听
auto pMeetingSDK = NEMeetingKit::getInstance();
auto ipcMeetingService = pMeetingSDK->getMeetingService();
if (ipcMeetingService) {
    ipcMeetingService->setOnInjectedMenuItemClickListener(&listener);
}
```

## 相关参考

### **API 参考**

| 类/接口 | 说明 |
| ---- | ---- |
| [NEMenuVisibility](https://doc.yunxin.163.com/docs/interface/meetingkit/linux/doxygen/Latest/zh/kit__define__meeting_8h.html#af33dfae958b63a441f26cf8b2ba8ca1a) | 菜单项可见性的枚举值。 |
| [NEMenuItemInfo](https://doc.yunxin.163.com/docs/interface/meetingkit/linux/doxygen/Latest/zh/kit__define__meeting_8h.html#a54ecdb4ace8e0e1e2d9e22abbf9013e1) | 自定义菜单项的 UI 展示。自定义一个标题与图标。 |
| [NEMeetingMenuItem](https://doc.yunxin.163.com/docs/interface/meetingkit/linux/doxygen/Latest/zh/class_n_e_meeting_menu_items.html) | 菜单项抽象基类。自定义菜单 ID 与菜单可见性，无法实例化。 |
| [NESingleStateMenuItem](https://doc.yunxin.163.com/docs/interface/meetingkit/linux/doxygen/Latest/zh/kit__define__meeting_8h.html#a63ae861eb0143c5eafeda29842768663) | 单状态菜单项实现类。此类菜单始终展示相同的标题与图标。 |
| [NECheckableMenuItem](https://doc.yunxin.163.com/docs/interface/meetingkit/linux/doxygen/Latest/zh/kit__define__meeting_8h.html#a9f82ce5de400037cb12ad39c10dd070c) | 双状态菜单项实现类。此类菜单包括选中和非选中两个状态，单击后可切换状态，并展示与当前状态对应的 UI。 |

### **菜单图标规格说明**

添加自定义菜单项时，建议图标资源的尺寸大小为 24px*24px。